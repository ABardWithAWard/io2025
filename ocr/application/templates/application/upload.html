{% extends "application/base.html" %}
{% block specific_content %}
<style>
    .upload-container {
    margin: auto;
    margin-top: 100px;
    width: 50%;
    }

    .container.mt-4 {
    margin: auto;
    width: 50%;
    }
</style>
<div class="upload-container">
<h2 style="margin: auto; width: 50%">Upload a File</h2>
<form style="margin: auto; width: 50%" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Upload</button>
</form>
<div class="container mt-4">
    <h2 class="mb-3">Uploaded Files</h2>
    <ul class="list-group" id="file-list">
    </ul>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        fetch("api/files") // Fetch files from Django API
            .then(response => response.json())
            .then(files => {
                const fileList = document.getElementById("file-list");
                files.forEach(file => {
                    const listItem = document.createElement("li");
                    listItem.className = "list-group-item";

                    // Create a download link for each file
                    const fileLink = document.createElement("a");
                    fileLink.href = `/media/${file}`;
                    fileLink.textContent = file;
                    fileLink.setAttribute("download", file);

                    listItem.appendChild(fileLink);
                    fileList.appendChild(listItem);
                });
            })
            .catch(error => console.error("Error fetching files:", error));
    });
</script>
</div>
{% endblock specific_content %}